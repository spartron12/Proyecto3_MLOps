[2025-11-08T21:06:09.211+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [queued]>
[2025-11-08T21:06:09.225+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [queued]>
[2025-11-08T21:06:09.225+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 2
[2025-11-08T21:06:09.243+0000] {taskinstance.py:1350} INFO - Executing <Task(PythonOperator): train_ml_model> on 2023-01-01 00:10:00+00:00
[2025-11-08T21:06:09.254+0000] {standard_task_runner.py:57} INFO - Started process 14898 to run task
[2025-11-08T21:06:09.264+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'orquestador', 'train_ml_model', 'scheduled__2023-01-01T00:10:00+00:00', '--job-id', '795', '--raw', '--subdir', 'DAGS_FOLDER/orquestador.py', '--cfg-path', '/tmp/tmpnr01gxgn']
[2025-11-08T21:06:09.267+0000] {standard_task_runner.py:85} INFO - Job 795: Subtask train_ml_model
[2025-11-08T21:06:09.595+0000] {task_command.py:410} INFO - Running <TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [running]> on host 068cff9bffb3
[2025-11-08T21:06:09.684+0000] {taskinstance.py:1568} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='orquestador' AIRFLOW_CTX_TASK_ID='train_ml_model' AIRFLOW_CTX_EXECUTION_DATE='2023-01-01T00:10:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-01-01T00:10:00+00:00'
[2025-11-08T21:06:09.685+0000] {crypto.py:83} WARNING - empty cryptography key - values will not be stored encrypted.
[2025-11-08T21:06:09.686+0000] {base.py:73} INFO - Using connection ID 'mysql_conn' for task execution.
[2025-11-08T21:06:09.701+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/***/providers/common/sql/hooks/sql.py:201: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  return psql.read_sql(sql, con=conn, params=parameters, **kwargs)

[2025-11-08T21:06:57.208+0000] {base.py:73} INFO - Using connection ID 'mysql_conn' for task execution.
[2025-11-08T21:06:57.214+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/***/providers/common/sql/hooks/sql.py:201: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  return psql.read_sql(sql, con=conn, params=parameters, **kwargs)

[2025-11-08T21:06:58.632+0000] {logging_mixin.py:149} INFO - Accuracy: 0.7356349367181887
[2025-11-08T21:06:58.677+0000] {logging_mixin.py:149} INFO - ðŸ”— Conectando a MLflow en http://10.43.100.98:8084
[2025-11-08T21:06:58.803+0000] {logging_mixin.py:149} WARNING - 2025/11/08 21:06:58 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
The git executable must be specified in one of the following ways:
    - be included in your $PATH
    - be set via $GIT_PYTHON_GIT_EXECUTABLE
    - explicitly set via git.refresh(<full-path-to-git-executable>)

All git commands will error until this is rectified.

This initial message can be silenced or aggravated in the future by setting the
$GIT_PYTHON_REFRESH environment variable. Use one of the following values:
    - quiet|q|silence|s|silent|none|n|0: for no message or exception
    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
    - error|e|exception|raise|r|2: for a raised exception

Example:
    export GIT_PYTHON_REFRESH=quiet
[2025-11-08T21:07:02.792+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")

[2025-11-08T21:07:02.895+0000] {credentials.py:1123} INFO - Found credentials in environment variables.
[2025-11-08T21:07:03.090+0000] {logging_mixin.py:149} INFO -  Run registrado en MLflow con nombre: GradientBoosting5
[2025-11-08T21:07:03.124+0000] {logging_mixin.py:149} WARNING - Registered model 'GradientBoostingModel' already exists. Creating a new version of this model...
[2025-11-08T21:07:03.156+0000] {logging_mixin.py:149} WARNING - 2025/11/08 21:07:03 INFO mlflow.tracking._model_registry.client: Waiting up to 300 seconds for model version to finish creation. Model name: GradientBoostingModel, version 3
[2025-11-08T21:07:03.157+0000] {logging_mixin.py:149} WARNING - Created version '3' of model 'GradientBoostingModel'.
[2025-11-08T21:07:03.158+0000] {logging_mixin.py:149} INFO - âœ… Modelo registrado con nombre='GradientBoostingModel' y versiÃ³n=3
[2025-11-08T21:07:03.200+0000] {logging_mixin.py:149} INFO - Modelo guardado localmente en: /opt/***/models/GradientBoosting.pkl
[2025-11-08T21:07:03.212+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-11-08T21:07:03.234+0000] {taskinstance.py:1368} INFO - Marking task as SUCCESS. dag_id=orquestador, task_id=train_ml_model, execution_date=20230101T001000, start_date=20251108T210609, end_date=20251108T210703
[2025-11-08T21:07:03.329+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-11-08T21:07:03.373+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-09T00:16:45.464+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [queued]>
[2025-11-09T00:16:45.477+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [queued]>
[2025-11-09T00:16:45.478+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 2
[2025-11-09T00:16:45.492+0000] {taskinstance.py:1350} INFO - Executing <Task(PythonOperator): train_ml_model> on 2023-01-01 00:10:00+00:00
[2025-11-09T00:16:45.502+0000] {standard_task_runner.py:57} INFO - Started process 562 to run task
[2025-11-09T00:16:45.512+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'orquestador', 'train_ml_model', 'scheduled__2023-01-01T00:10:00+00:00', '--job-id', '31', '--raw', '--subdir', 'DAGS_FOLDER/orquestador.py', '--cfg-path', '/tmp/tmp4ongmb01']
[2025-11-09T00:16:45.516+0000] {standard_task_runner.py:85} INFO - Job 31: Subtask train_ml_model
[2025-11-09T00:16:45.827+0000] {task_command.py:410} INFO - Running <TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [running]> on host abefff83dc87
[2025-11-09T00:16:45.933+0000] {taskinstance.py:1568} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='orquestador' AIRFLOW_CTX_TASK_ID='train_ml_model' AIRFLOW_CTX_EXECUTION_DATE='2023-01-01T00:10:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-01-01T00:10:00+00:00'
[2025-11-09T00:16:45.937+0000] {crypto.py:83} WARNING - empty cryptography key - values will not be stored encrypted.
[2025-11-09T00:16:45.938+0000] {base.py:73} INFO - Using connection ID 'mysql_conn' for task execution.
[2025-11-09T00:16:45.956+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/***/providers/common/sql/hooks/sql.py:201: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  return psql.read_sql(sql, con=conn, params=parameters, **kwargs)

[2025-11-09T00:16:49.104+0000] {logging_mixin.py:149} INFO - Columnas despuÃ©s del rename: ['discharge_disposition_id', 'admission_source_id', 'time_in_hospital', 'num_lab_procedures', 'num_procedures', 'num_medications', 'number_outpatient', 'number_emergency', 'number_inpatient', 'number_diagnoses', 'max_glu_serum', 'A1Cresult', 'readmitted', 'race_AfricanAmerican', 'race_Asian', 'race_Caucasian', 'race_Hispanic', 'race_Other', 'gender_Female', 'gender_Male', 'age_0_10', 'age_10_20', 'age_20_30', 'age_30_40', 'age_40_50', 'age_50_60', 'age_60_70', 'age_70_80', 'age_80_90', 'age_90_100', 'cambio_Ch', 'cambio_No', 'diabetesMed_No', 'diabetesMed_Yes', 'diag_1_Circulatory', 'diag_1_Diabetes', 'diag_1_Digestive', 'diag_1_Genitourinary', 'diag_1_Injury', 'diag_1_Musculoskeletal', 'diag_1_Neoplasms', 'diag_1_Other', 'diag_1_Respiratory', 'diag_2_Circulatory', 'diag_2_Diabetes', 'diag_2_Digestive', 'diag_2_Genitourinary', 'diag_2_Injury', 'diag_2_Musculoskeletal', 'diag_2_Neoplasms', 'diag_2_Other', 'diag_2_Respiratory', 'diag_3_Circulatory', 'diag_3_Diabetes', 'diag_3_Digestive', 'diag_3_Genitourinary', 'diag_3_Injury', 'diag_3_Musculoskeletal', 'diag_3_Neoplasms', 'diag_3_Other', 'diag_3_Respiratory']
[2025-11-09T00:17:05.926+0000] {process_utils.py:131} INFO - Sending Signals.SIGTERM to group 562. PIDs of all processes in the group: [562]
[2025-11-09T00:17:05.927+0000] {process_utils.py:86} INFO - Sending the signal Signals.SIGTERM to group 562
[2025-11-09T00:17:06.124+0000] {taskinstance.py:1540} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-11-09T00:17:06.138+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/scripts/funciones.py", line 491, in train_model
    model = GradientBoostingClassifier(
  File "/home/airflow/.local/lib/python3.9/site-packages/sklearn/ensemble/_gb.py", line 538, in fit
    n_stages = self._fit_stages(
  File "/home/airflow/.local/lib/python3.9/site-packages/sklearn/ensemble/_gb.py", line 615, in _fit_stages
    raw_predictions = self._fit_stage(
  File "/home/airflow/.local/lib/python3.9/site-packages/sklearn/ensemble/_gb.py", line 257, in _fit_stage
    tree.fit(X, residual, sample_weight=sample_weight, check_input=False)
  File "/home/airflow/.local/lib/python3.9/site-packages/sklearn/tree/_classes.py", line 1247, in fit
    super().fit(
  File "/home/airflow/.local/lib/python3.9/site-packages/sklearn/tree/_classes.py", line 379, in fit
    builder.build(self.tree_, X, y, sample_weight)
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1542, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2025-11-09T00:17:06.150+0000] {taskinstance.py:1368} INFO - Marking task as FAILED. dag_id=orquestador, task_id=train_ml_model, execution_date=20230101T001000, start_date=20251109T001645, end_date=20251109T001706
[2025-11-09T00:17:06.164+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 31 for task train_ml_model ((psycopg2.errors.ForeignKeyViolation) insert or update on table "task_fail" violates foreign key constraint "task_fail_ti_fkey"
DETAIL:  Key (dag_id, task_id, run_id, map_index)=(orquestador, train_ml_model, scheduled__2023-01-01T00:10:00+00:00, -1) is not present in table "task_instance".

[SQL: INSERT INTO task_fail (task_id, dag_id, run_id, map_index, start_date, end_date, duration) VALUES (%(task_id)s, %(dag_id)s, %(run_id)s, %(map_index)s, %(start_date)s, %(end_date)s, %(duration)s) RETURNING task_fail.id]
[parameters: {'task_id': 'train_ml_model', 'dag_id': 'orquestador', 'run_id': 'scheduled__2023-01-01T00:10:00+00:00', 'map_index': -1, 'start_date': datetime.datetime(2025, 11, 9, 0, 16, 45, 466235, tzinfo=Timezone('UTC')), 'end_date': datetime.datetime(2025, 11, 9, 0, 17, 6, 150116, tzinfo=Timezone('UTC')), 'duration': 20}]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 562)
[2025-11-09T00:17:06.220+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=562, status='terminated', exitcode=1, started='00:16:44') (562) terminated with exit code 1
[2025-11-09T00:32:51.946+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [queued]>
[2025-11-09T00:32:51.968+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [queued]>
[2025-11-09T00:32:51.968+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 2
[2025-11-09T00:32:51.984+0000] {taskinstance.py:1350} INFO - Executing <Task(PythonOperator): train_ml_model> on 2023-01-01 00:10:00+00:00
[2025-11-09T00:32:51.994+0000] {standard_task_runner.py:57} INFO - Started process 1010 to run task
[2025-11-09T00:32:52.007+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'orquestador', 'train_ml_model', 'scheduled__2023-01-01T00:10:00+00:00', '--job-id', '61', '--raw', '--subdir', 'DAGS_FOLDER/orquestador.py', '--cfg-path', '/tmp/tmpw4lnvbbg']
[2025-11-09T00:32:52.012+0000] {standard_task_runner.py:85} INFO - Job 61: Subtask train_ml_model
[2025-11-09T00:32:52.343+0000] {task_command.py:410} INFO - Running <TaskInstance: orquestador.train_ml_model scheduled__2023-01-01T00:10:00+00:00 [running]> on host abefff83dc87
[2025-11-09T00:32:52.449+0000] {taskinstance.py:1568} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='orquestador' AIRFLOW_CTX_TASK_ID='train_ml_model' AIRFLOW_CTX_EXECUTION_DATE='2023-01-01T00:10:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-01-01T00:10:00+00:00'
[2025-11-09T00:32:52.451+0000] {crypto.py:83} WARNING - empty cryptography key - values will not be stored encrypted.
[2025-11-09T00:32:52.452+0000] {base.py:73} INFO - Using connection ID 'mysql_conn' for task execution.
[2025-11-09T00:32:52.467+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/***/providers/common/sql/hooks/sql.py:201: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  return psql.read_sql(sql, con=conn, params=parameters, **kwargs)

[2025-11-09T00:32:56.017+0000] {logging_mixin.py:149} INFO - Columnas despuÃ©s del rename: ['discharge_disposition_id', 'admission_source_id', 'time_in_hospital', 'num_lab_procedures', 'num_procedures', 'num_medications', 'number_outpatient', 'number_emergency', 'number_inpatient', 'number_diagnoses', 'max_glu_serum', 'A1Cresult', 'readmitted', 'race_AfricanAmerican', 'race_Asian', 'race_Caucasian', 'race_Hispanic', 'race_Other', 'gender_Female', 'gender_Male', 'age_0_10', 'age_10_20', 'age_20_30', 'age_30_40', 'age_40_50', 'age_50_60', 'age_60_70', 'age_70_80', 'age_80_90', 'age_90_100', 'cambio_Ch', 'cambio_No', 'diabetesMed_No', 'diabetesMed_Yes', 'diag_1_Circulatory', 'diag_1_Diabetes', 'diag_1_Digestive', 'diag_1_Genitourinary', 'diag_1_Injury', 'diag_1_Musculoskeletal', 'diag_1_Neoplasms', 'diag_1_Other', 'diag_1_Respiratory', 'diag_2_Circulatory', 'diag_2_Diabetes', 'diag_2_Digestive', 'diag_2_Genitourinary', 'diag_2_Injury', 'diag_2_Musculoskeletal', 'diag_2_Neoplasms', 'diag_2_Other', 'diag_2_Respiratory', 'diag_3_Circulatory', 'diag_3_Diabetes', 'diag_3_Digestive', 'diag_3_Genitourinary', 'diag_3_Injury', 'diag_3_Musculoskeletal', 'diag_3_Neoplasms', 'diag_3_Other', 'diag_3_Respiratory']
[2025-11-09T00:32:56.072+0000] {logging_mixin.py:149} INFO - ====================================================================================================
[2025-11-09T00:32:56.072+0000] {logging_mixin.py:149} INFO - 
ðŸ§© Tipos de variables en X_train:
[2025-11-09T00:32:56.073+0000] {logging_mixin.py:149} INFO -   discharge_disposition_id: int64
[2025-11-09T00:32:56.073+0000] {logging_mixin.py:149} INFO -   admission_source_id: int64
[2025-11-09T00:32:56.073+0000] {logging_mixin.py:149} INFO -   time_in_hospital: int64
[2025-11-09T00:32:56.073+0000] {logging_mixin.py:149} INFO -   num_lab_procedures: int64
[2025-11-09T00:32:56.073+0000] {logging_mixin.py:149} INFO -   num_procedures: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   num_medications: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   number_outpatient: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   number_emergency: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   number_inpatient: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   number_diagnoses: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   max_glu_serum: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   A1Cresult: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   race_AfricanAmerican: int64
[2025-11-09T00:32:56.074+0000] {logging_mixin.py:149} INFO -   race_Asian: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   race_Caucasian: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   race_Hispanic: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   race_Other: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   gender_Female: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   gender_Male: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   age_0_10: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   age_10_20: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   age_20_30: int64
[2025-11-09T00:32:56.075+0000] {logging_mixin.py:149} INFO -   age_30_40: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   age_40_50: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   age_50_60: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   age_60_70: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   age_70_80: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   age_80_90: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   age_90_100: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   cambio_Ch: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   cambio_No: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   diabetesMed_No: int64
[2025-11-09T00:32:56.076+0000] {logging_mixin.py:149} INFO -   diabetesMed_Yes: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Circulatory: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Diabetes: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Digestive: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Genitourinary: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Injury: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Musculoskeletal: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Neoplasms: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Other: int64
[2025-11-09T00:32:56.077+0000] {logging_mixin.py:149} INFO -   diag_1_Respiratory: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Circulatory: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Diabetes: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Digestive: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Genitourinary: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Injury: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Musculoskeletal: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Neoplasms: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Other: int64
[2025-11-09T00:32:56.078+0000] {logging_mixin.py:149} INFO -   diag_2_Respiratory: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Circulatory: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Diabetes: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Digestive: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Genitourinary: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Injury: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Musculoskeletal: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Neoplasms: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Other: int64
[2025-11-09T00:32:56.079+0000] {logging_mixin.py:149} INFO -   diag_3_Respiratory: int64
[2025-11-09T00:32:56.080+0000] {logging_mixin.py:149} INFO - 
ðŸŽ¯ Tipo de variable objetivo (y_train): object
[2025-11-09T00:33:41.613+0000] {base.py:73} INFO - Using connection ID 'mysql_conn' for task execution.
[2025-11-09T00:33:41.622+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/***/providers/common/sql/hooks/sql.py:201: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  return psql.read_sql(sql, con=conn, params=parameters, **kwargs)

[2025-11-09T00:33:42.850+0000] {logging_mixin.py:149} INFO - Columnas despuÃ©s del rename: ['discharge_disposition_id', 'admission_source_id', 'time_in_hospital', 'num_lab_procedures', 'num_procedures', 'num_medications', 'number_outpatient', 'number_emergency', 'number_inpatient', 'number_diagnoses', 'max_glu_serum', 'A1Cresult', 'readmitted', 'race_AfricanAmerican', 'race_Asian', 'race_Caucasian', 'race_Hispanic', 'race_Other', 'gender_Female', 'gender_Male', 'age_0_10', 'age_10_20', 'age_20_30', 'age_30_40', 'age_40_50', 'age_50_60', 'age_60_70', 'age_70_80', 'age_80_90', 'age_90_100', 'cambio_Ch', 'cambio_No', 'diabetesMed_No', 'diabetesMed_Yes', 'diag_1_Circulatory', 'diag_1_Diabetes', 'diag_1_Digestive', 'diag_1_Genitourinary', 'diag_1_Injury', 'diag_1_Musculoskeletal', 'diag_1_Neoplasms', 'diag_1_Other', 'diag_1_Respiratory', 'diag_2_Circulatory', 'diag_2_Diabetes', 'diag_2_Digestive', 'diag_2_Genitourinary', 'diag_2_Injury', 'diag_2_Musculoskeletal', 'diag_2_Neoplasms', 'diag_2_Other', 'diag_2_Respiratory', 'diag_3_Circulatory', 'diag_3_Diabetes', 'diag_3_Digestive', 'diag_3_Genitourinary', 'diag_3_Injury', 'diag_3_Musculoskeletal', 'diag_3_Neoplasms', 'diag_3_Other', 'diag_3_Respiratory']
[2025-11-09T00:33:42.868+0000] {logging_mixin.py:149} INFO - Columnas despuÃ©s del rename: ['discharge_disposition_id', 'admission_source_id', 'time_in_hospital', 'num_lab_procedures', 'num_procedures', 'num_medications', 'number_outpatient', 'number_emergency', 'number_inpatient', 'number_diagnoses', 'max_glu_serum', 'A1Cresult', 'race_AfricanAmerican', 'race_Asian', 'race_Caucasian', 'race_Hispanic', 'race_Other', 'gender_Female', 'gender_Male', 'age_0_10', 'age_10_20', 'age_20_30', 'age_30_40', 'age_40_50', 'age_50_60', 'age_60_70', 'age_70_80', 'age_80_90', 'age_90_100', 'cambio_Ch', 'cambio_No', 'diabetesMed_No', 'diabetesMed_Yes', 'diag_1_Circulatory', 'diag_1_Diabetes', 'diag_1_Digestive', 'diag_1_Genitourinary', 'diag_1_Injury', 'diag_1_Musculoskeletal', 'diag_1_Neoplasms', 'diag_1_Other', 'diag_1_Respiratory', 'diag_2_Circulatory', 'diag_2_Diabetes', 'diag_2_Digestive', 'diag_2_Genitourinary', 'diag_2_Injury', 'diag_2_Musculoskeletal', 'diag_2_Neoplasms', 'diag_2_Other', 'diag_2_Respiratory', 'diag_3_Circulatory', 'diag_3_Diabetes', 'diag_3_Digestive', 'diag_3_Genitourinary', 'diag_3_Injury', 'diag_3_Musculoskeletal', 'diag_3_Neoplasms', 'diag_3_Other', 'diag_3_Respiratory']
[2025-11-09T00:33:43.140+0000] {logging_mixin.py:149} INFO - Accuracy: 0.7588939502315251
[2025-11-09T00:33:43.181+0000] {logging_mixin.py:149} INFO - ðŸ”— Conectando a MLflow en http://10.43.100.98:8084
[2025-11-09T00:33:43.299+0000] {logging_mixin.py:149} WARNING - 2025/11/09 00:33:43 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
The git executable must be specified in one of the following ways:
    - be included in your $PATH
    - be set via $GIT_PYTHON_GIT_EXECUTABLE
    - explicitly set via git.refresh(<full-path-to-git-executable>)

All git commands will error until this is rectified.

This initial message can be silenced or aggravated in the future by setting the
$GIT_PYTHON_REFRESH environment variable. Use one of the following values:
    - quiet|q|silence|s|silent|none|n|0: for no message or exception
    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
    - error|e|exception|raise|r|2: for a raised exception

Example:
    export GIT_PYTHON_REFRESH=quiet
[2025-11-09T00:33:47.485+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.9/site-packages/_distutils_hack/__init__.py:33: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")

[2025-11-09T00:33:47.591+0000] {credentials.py:1123} INFO - Found credentials in environment variables.
[2025-11-09T00:33:47.780+0000] {logging_mixin.py:149} INFO -  Run registrado en MLflow con nombre: GradientBoosting5
[2025-11-09T00:33:47.813+0000] {logging_mixin.py:149} WARNING - Registered model 'GradientBoostingModel' already exists. Creating a new version of this model...
[2025-11-09T00:33:47.843+0000] {logging_mixin.py:149} WARNING - 2025/11/09 00:33:47 INFO mlflow.tracking._model_registry.client: Waiting up to 300 seconds for model version to finish creation. Model name: GradientBoostingModel, version 5
[2025-11-09T00:33:47.844+0000] {logging_mixin.py:149} WARNING - Created version '5' of model 'GradientBoostingModel'.
[2025-11-09T00:33:47.844+0000] {logging_mixin.py:149} INFO - âœ… Modelo registrado con nombre='GradientBoostingModel' y versiÃ³n=5
[2025-11-09T00:33:47.877+0000] {logging_mixin.py:149} INFO - Modelo guardado localmente en: /opt/***/models/GradientBoosting.pkl
[2025-11-09T00:33:47.889+0000] {python.py:183} INFO - Done. Returned value was: None
[2025-11-09T00:33:47.901+0000] {taskinstance.py:1368} INFO - Marking task as SUCCESS. dag_id=orquestador, task_id=train_ml_model, execution_date=20230101T001000, start_date=20251109T003251, end_date=20251109T003347
[2025-11-09T00:33:47.973+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 0
[2025-11-09T00:33:48.015+0000] {taskinstance.py:2674} INFO - 1 downstream tasks scheduled from follow-on schedule check
